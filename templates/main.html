<style type="text/css">
	@import url("{global.datadir}data/css/menu.css");
</style>
<script type="text/javascript" language="JavaScript">
<!--
	{if show.gfxpakwarning}
		alert('Die von ihnen verwendete Version des Grafikpaks ist veraltet. Die Benutzung des Grafikpaks wurde daher deaktiviert.\nBitte laden sie sich die neuste Version des Grafikpaks herunter!');
	{/endif}
	
	/*
		Mail Check
	*/

	PeriodicalExecuter.prototype.registerCallback = function() {
		this.intervalID = setInterval(this.onTimerEvent.bind(this), this.frequency * 1000);
	}

	PeriodicalExecuter.prototype.stop = function() {
		clearInterval(this.intervalID);
	}

	function checkPMStatus() {
		var url = getDsUrl();
		var params = 'module={global.module}&action=hasNewPm&autoAccess=true';

		var myAjax = new Ajax.Request( url, {
				method: 'get', 
				parameters: params, 
				onComplete: updatePMStatus
			});
	}
	
	function updatePMStatus( originalRequest ) {
		var response = originalRequest.responseText;
		
		if( response.indexOf('nicht eingeloggt') > -1 ) {
			checkPMStatusExecuter.stop();
			return;
		}
		
		if( originalRequest.responseText == '1' ) {
			$('mailicon').style.display='inline';
		}
		else {
			$('mailicon').style.display='none';
		}
	}

	var checkPMStatusExecuter = new PeriodicalExecuter(checkPMStatus, 30);
	
	/*
		Boxfunktionen
	*/
	
	function boxClose(box) {
		$(box).style.display = 'none';
	}
	
	function boxOpen(box) {
		$(box).style.display = 'block';
		
		if( box == 'helpbox' ) {
			helpBox.fetchHelpText();
		}
	}
	
	var helpBox = {
		isVisible : function() {
			if( $('helpbox').style.display == 'block' ) {
				return true;
			}
			return false;
		},
		fetchHelpText : function() {
			$('helpboxtext').innerHTML = '';
			
			var myAjax = new Ajax.Request( getDsUrl(),  {
				method: 'get', 
				parameters: 'module={global.module}&action=getHelpText&page='+currentModule, 
				onComplete: helpBox.updateHelpText
			});
		},
		updateHelpText : function( originalRequest ) {
			var response = originalRequest.responseText;
			
			if( response.indexOf('Sie muessen sich einloggen') > -1 ) {
				location.href = getDsUrl()+"?module=portal&action=login";
				return;
			}
			
			$('helpboxtext').innerHTML = response;
		}
	}
	
	var adminBox = {
		execute : function() {
			var cmd = $('adminConsoleCommand').value;
			$('adminConsoleResponse').innerHTML = '';
			var myAjax = new Ajax.Request( getDsUrl(),  {
				method: 'get', 
				parameters: 'module=admin&action=ajax&namedplugin=net.driftingsouls.ds2.server.modules.admin.AdminConsole&responseOnly=1&cmd='+encodeURIComponent(cmd), 
				onComplete: adminBox.showResponse
			});
		},
		
		showResponse : function( originalRequest ) {
			var response = originalRequest.responseText;
			
			if( response.indexOf('Sie muessen sich einloggen') > -1 ) {
				location.href = getDsUrl()+"?module=portal&action=login";
				return;
			}
			
			$('adminConsoleResponse').innerHTML = response;
		}
	}
	
	/*
		Page-Funktionen
	*/
	var currentModule;
	var currentTitle;
	
	function setCurrentPage(module, title) {
		var link = $('page_'+currentModule);
		if( link ) {
			link.className='';
		}
		else {
			$('page_currentpage').style.display='none';
			
			// Submenue leeren
			var currentPageLi = $('currentpage');
			var dl = currentPageLi.getElementsByTagName('dl')[0];
			var dds = dl.getElementsByTagName('dd');
			while( dds.length > 0 ) {
				dl.removeChild(dds[0]);
			}
		}
	
		var link = $('page_'+module);
		if( link ) {
			link.className='currentPage';
		}
		else if( title != 'null' ) {
			var reducedTitle = title;
			if( reducedTitle.length > 16 ) {
				reducedTitle = reducedTitle.substring(0,16)+"...";
			}
			$('page_currentpage').firstChild.nodeValue = reducedTitle;
			$('page_currentpage').style.display='inline';
			$('page_currentpage_dropdown').style.display = 'none';
		}
		
		var oldModule = currentModule;
		
		currentModule = module;
		currentTitle = title;
		
		if( helpBox.isVisible() && oldModule != currentModule ) {
			helpBox.fetchHelpText();
		}
	}
	
	function addPageMenuEntry(title, url) {
		var currentPageLi = $('currentpage');
		
		var dl = currentPageLi.getElementsByTagName('dl')[0];
		var dd = document.createElement('dd');
		var a = document.createElement('a');
		a.href = url;
		a.appendChild(document.createTextNode(title));
		a.target = 'main';
		dd.appendChild(a);
		dl.appendChild(dd);
		
		$('page_currentpage_dropdown').style.display = 'inline';
	}
	
	function completePage() {
		var currentPageLi = $('currentpage');
		var dds = currentPageLi.getElementsByTagName('dd');
		
		if( dds.length > 0 ) {
			var dl = currentPageLi.getElementsByTagName('dl')[0];
			var dd = document.createElement('dd');
			dd.className = 'lastelement';
			
			var span = document.createElement('span');
			dd.appendChild(span);
			dl.appendChild(dd);
		}
	}
-->
</script>
<ul id="menu">
<li class="statusfield">
	<a id="mailicon" href="./ds?module=comm&amp&action=showInbox" target="main"><img src="{global.datadir}/data/interface/menubar/mail.png" alt="Neue Nachricht" title="Du hast neue Nachrichten erhalten" /></a>
</li>
<li id="currentpage">
	<dl>
		<dt>
			<span id="page_currentpage" class="currentPage">empty <img id="page_currentpage_dropdown" src="{global.datadir}/data/interface/menubar/submenu.png" alt="" /></span>
		</dt>
	</dl>
</li>
<li>
	<dl>
		<dt>
			<a id="page_ueber" href="./ds?module=ueber" target="main">&Uuml;bersicht</a>
		</dt>
	</dl>
</li>
<li>
	<dl>
		<dt>
			<a id="page_basen" href="./ds?module=basen" target="main">Basen <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" /></a>
		</dt>
		<!-- BEGIN bases.listitem -->
			<dd>
				<a href="./ds?module=base&amp;col={base.id}" target="main">
					{base.name}
				</a>
			</dd>
		<!-- END bases.listitem -->
		{if bases.list}
			<dd class="lastelement">
				<span></span>
			</dd>
		{/endif}
	</dl>
</li>
<li>	
	<dl>
		<dt>
			<a id="page_schiffe" href="./ds?module=schiffe" target="main">Schiffe</a>
			<a class="low" href="./ds?module=schiffe&amp;low=9" target="main">X</a>
			<img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
		</dt>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=zivil" target="main">
					Zivilschiffe
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=zivil&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=tank" target="main">
					Tanker
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=tank&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=trans" target="main">
					Frachter
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=trans&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=versorger" target="main">
					Versorger
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=versorger&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=cargo" target="main">
					Stationen
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=cargo&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=werften" target="main">
					Werften
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=werften&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=sensor" target="main">
					Awacs
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=sensor&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<hr style="margin:0px;" noshade="noshade" size="1" style="color:#cccccc" />
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf" target="main">
					Kriegsschiffe
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=2" target="main">
					Zerst&ouml;rer
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=2&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=15" target="main">
					Tr&auml;ger
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=15&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=5" target="main">
					Korvetten
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=5&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=7" target="main">
					Schwere Kreuzer
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=7&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=6" target="main">
					Kreuzer
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=6&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=9" target="main">
					J&auml;ger
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=9&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=17" target="main">
					Bomber
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=kampf&amp;kampf_only=17&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd>
			<span>
				<a href="./ds?module=schiffe&amp;only=def" target="main">
					Orbitalabwehr
				</a>
				<a class="low" href="./ds?module=schiffe&amp;only=def&amp;low=9" target="main">X</a>
			</span>
		</dd>
		<dd class="lastelement">
			<span></span>
		</dd>
	</dl>
</li>
<li>	
	<dl>
		<dt>
			Kommunikation <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
		</dt>
		<dd>
			<a href="./ds?module=comm&action=showInbox" target="main">
				PMs
			</a>
		</dd>
		<dd>
			<a href="./ds?module=comnet" target="main">
				Com-Net
			</a>
		</dd>
		<dd>
			<a href="./ds?module=handel" target="main">
				Handel
			</a>
		</dd>
		<dd>
			<a href="./ds?module=ersteigern" target="main">
				Fraktionen
			</a>
		</dd>
		<dd>
			<a href="./ds?module=ally" target="main">
				Allianzen
			</a>
		</dd>
		<dd>
			<a href="{SCRIPT_FORUM}" target="main">
				Forum
			</a>
		</dd>
		<dd class="lastelement">
			<span></span>
		</dd>
	</dl>
</li>
<li>	
	<dl>
		<dt> 	
			Datenbank <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
		</dt>
		<dd>
			<a href="./ds?module=map&amp;sys=1&amp;loadmap=0" target="main">Sternenkarte</a>
		</dd>	
		<dd>
			<a href="./ds?module=stats" target="main">Statistik</a>
		</dd>
		<dd>
			<a href="./ds?module=techliste" target="main">Forschungen</a>
		</dd>
		<dd>
			<a href="./ds?module=buildings" target="main">Geb&auml;ude</a>
		</dd>
		<dd>
			<a href="./ds?module=iteminfo&amp;action=known" target="main">Gegenst&auml;nde</a>
		</dd>
		<dd>
			<a href="./ds?module=unitinfo&amp;action=list" target="main">Einheiten</a>
		</dd>
		<dd>
			<a href="./ds?module=techdatabase&amp;action=facts" target="main">
				Artikel
			</a>
		</dd>
		<dd>
			<a href="http://ds.drifting-souls.net/Schiffsliste.htm" target="main">
				Schiffsliste
			</a>
		</dd>
		<dd>
			<a href="http://ds.drifting-souls.net/Schiffsvergleich.htm" target="main">
				Schiffsvergleich
			</a>
		</dd>
		<dd>
			<a href="http://wiki.drifting-souls.net/" target="main">Wiki</a>
		</dd>
		<dd class="lastelement">
			<span></span>
		</dd>
	</dl>
</li>
<li>	
	<dl>
		<dt>
			Optionen <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
		</dt>
		<dd>
			<a href="./ds?module=options" target="main">
				Allgemein
			</a>
		</dd>
		<dd>
			<a href="./ds?module=options&amp;action=changeNamePass" target="main">
				Passwort
			</a>
		</dd>
		<dd>
			<a href="./ds?module=options&amp;action=xtra" target="main">
				Erweitert
			</a>
		</dd>
		<dd>
			<a style="color:red" href="./ds?module=options&amp;action=delAccount" target="main">
				L&ouml;schantrag
			</a>
		</dd>
		<dd class="lastelement">
			<span></span>
		</dd>
	</dl>
</li>
{if user.npc}
	<li>	
		<dl>
			<dt> 	
				Spezial <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
			</dt>
			<dd>
				<a id="page_npcorder" href="./ds?module=npcorder" target="main">NPC</a>
			</dd>
			{if user.admin}
				<dd>
					<a id="page_admin" href="./ds?module=admin" target="main">Admin</a>
				</dd>
			{/endif}
			<dd class="lastelement">
				<span></span>
			</dd>
		</dl>
	</li>
{else}
	{if user.admin}
		<li>	
			<dl>
				<dt> 	
					Spezial <img src="{global.datadir}/data/interface/menubar/submenu.png" alt="" />
				</dt>
				<dd>
					<a id="page_admin" href="./ds?module=admin" target="main">Admin</a>
				</dd>
				<dd class="lastelement">
					<span></span>
				</dd>
			</dl>
		</li>
	{/endif}
{/endif}
<li class="actionfield">
	<a href="#" onclick="boxOpen('helpbox')">
		<img id="helpicon" src="{global.datadir}/data/interface/menubar/help.png" alt="Hilfe" title="Hilfe" />
	</a>
	{if admin.showconsole}
		<a href="#" onclick="boxOpen('adminconsolebox')">
			<img id="adminconsoleicon" src="{global.datadir}/data/interface/menubar/adminconsole.png" alt="Adminconsole" title="Adminconsole" />
		</a>
	{/endif}
	<a href="#" onclick="boxOpen('searchbox')">
		<img id="searchicon" src="{global.datadir}/data/interface/menubar/search.png" alt="Suchen" title="Suchen" />
	</a>
	<a href="#" onclick="boxOpen('noticebox')">
		<img id="noticeicon" src="{global.datadir}/data/interface/menubar/notice.png" alt="Notizen" title="Notizen verwalten" />
	</a>
	&nbsp;
	<a href="./ds?module=logout" target="main">
		<img src="{global.datadir}/data/interface/menubar/logout.png" alt="Logout" title="Ausloggen" />
	</a>
</li>
</ul>

<!-- Notizbox -->
<div id="noticebox" class="gfxbox"><div><div><div>
	<h3>Notizen</h3>
	<textarea rows="15" cols="50">Deine Notizen</textarea>
	<button type="button" onclick="boxClose('noticebox')" value="Schlie&szlig;en">Schlie&szlig;en</button>
</div></div></div></div>

<!-- Hilfebox -->
<div id="helpbox" class="gfxbox"><div><div><div>
	<h3>Hilfe</h3>
	<div id="helpboxtext"></div>
	<button type="button" onclick="boxClose('helpbox')" value="Schlie&szlig;en">Schlie&szlig;en</button>
</div></div></div></div>

{if admin.showconsole}
	<!-- Adminconsole -->
	<div id="adminconsolebox" class="gfxbox"><div><div><div>
		<h3>Adminconsole</h3>
		<input id="adminConsoleCommand" type="text" name="search" style="width:300px" />
		<button type="button" onclick="adminBox.execute()" style="width:80px">ausf&uuml;hren</button>
		<div id="adminConsoleResponse"> </div>
		<button type="button" onclick="boxClose('adminconsolebox')" value="Schlie&szlig;en">Schlie&szlig;en</button>
	</div></div></div></div>
{/endif}

<!-- Suche -->
<div id="searchbox" class="gfxbox"><div><div><div>
	<h3>Suchen</h3>
	<form action="./ds" method="post" target="search">
		<input type="text" name="search" style="width:300px" />
		<input class="submit" type="submit" value="Suchen" style="width:60px" />
		{!form_create_hidden default, module:search}
	</form>
	<iframe id="searchframe" name="search" scrolling="auto" frameborder="0" src="./ds?module=search"></iframe>
	<button type="button" onclick="boxClose('searchbox')" value="Schlie&szlig;en">Schlie&szlig;en</button>
</div></div></div></div>

<!-- Frame -->
<iframe id="mainframe" name="main" scrolling="auto" frameborder="0" src="./ds?module=ueber">
	Dein Browser unterst&uuml;tzt leider keine iframes. Am besten installierst du einen Browser neueren Datums wie z.B. den <a class="forschinfo" href="http://www.mozilla.org">Mozilla Firefox</a>
</iframe>
<script type="text/javascript" language="JavaScript">
<!--
	checkPMStatus();
	new Draggable('noticebox');
	new Draggable('adminconsolebox');
	new Draggable('helpbox');
	new Draggable('searchbox');
-->
</script>